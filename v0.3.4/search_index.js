var documenterSearchIndex = {"docs":
[{"location":"poincare_invariants/#Poincaré-Integral-Invariants","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"","category":"section"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"Poincaré integral invariants provide useful diagnostics for analysing the long-time accuracy of numerical integrators for Hamiltonian dynamics and for distinguishing between symplectic and non-symplectic integrators.","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"This package provides means for computing the first and second Poincaré integral invariant vartheta and omega, which are given by the Lagrangian one- and two-form, respectively.","category":"page"},{"location":"poincare_invariants/#First-Poincaré-Invariant","page":"Poincaré Integral Invariants","title":"First Poincaré Invariant","text":"","category":"section"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"The one-form vartheta is a relative integral invariant, which means that the integral","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"I_1 = int_gamma vartheta_i (q)  dq^i","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"stays constant in time when gamma is a closed loop in the configuration space mathcalM (a compact one-dimensional parametrized submanifold of mathcalM without boundary), that is advected along the solution of the dynamics.","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"(Image: )","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"The figure shows examples of single trajectories of some samples of such a loop, as well as the temporal evolution of the whole loop following the dynamics of the guiding centre system.","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"The loop gamma is parametrized by tau in 01), so that","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"I_1 (t) = int_0^1 vartheta_i (q_(tau)(t))  dfracd q_(tau)^idtau  dtau ","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"In order to compute this integral, we use N equidistant points in 01), so that the derivatives d q_(tau)  dtau can be efficiently computed via discrete Fourier transforms. The integral is approximated with the trapezoidal quadrature rule, which has spectral convergence on periodic domains (Trefethen & Weideman, 2014).","category":"page"},{"location":"poincare_invariants/#Second-Poincaré-Invariant","page":"Poincaré Integral Invariants","title":"Second Poincaré Invariant","text":"","category":"section"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"The two-form omega is an absolute integral invariant, which means that the integral","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"I_2 = int_S omega_ij (q)  dq^i  dq^j","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"stays constant in time when S is any compact two-dimensional parametrized submanifold of mathcalM, advected along the solution of the dynamics.","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"(Image: )","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"The figure shows how an initially rectangular area in phasespace is advected by the dynamics of the guiding centre system.","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"The area S is parametrized by (sigma tau) in 01^2, so that","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"I_2 (t) = int_0^1 int_0^1 omega_ij (q_(sigma tau) (t))  dfracdq_(sigma tau)^idsigma  dfracdq_(sigma tau)^jdtau  dsigma  dtau ","category":"page"},{"location":"poincare_invariants/","page":"Poincaré Integral Invariants","title":"Poincaré Integral Invariants","text":"Here, we represent the surface in terms of Chebyshev polynomials and thus use Chebyshev points for the discretization of the domain 01^2. The Chebyshev polynomials allow for an extremely accurate approximation of the surface, even if the latter becomes severely deformed. Moreover, they allow for the use of the ApproxFun.jl package for the easy and accurate computation of the derivatives and the integral.","category":"page"},{"location":"poincare_invariant_1st/#st-Poincaré-Integral-Invariant","page":"1st Poincaré Invariant","title":"1st Poincaré Integral Invariant","text":"","category":"section"},{"location":"poincare_invariant_1st/","page":"1st Poincaré Invariant","title":"1st Poincaré Invariant","text":"Modules = [PoincareInvariants]\nPages   = [\"src/poincare_invariant_1st.jl\",\n           \"src/poincare_invariant_1st_canonical.jl\",\n           \"src/poincare_invariant_1st_common.jl\"]","category":"page"},{"location":"#PoincareInvariants.jl","page":"Home","title":"PoincareInvariants.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Julia library for the computation of Poincaré integral invariants.","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: PkgEval Status) (Image: CI) (Image: Build Status) (Image: Coverage Status) (Image: codecov) (Image: DOI)","category":"page"},{"location":"#License","page":"Home","title":"License","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Copyright (c) Michael Kraus <michael.kraus@ipp.mpg.de>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","category":"page"},{"location":"poincare_invariant_2nd/#nd-Poincaré-Integral-Invariant","page":"2nd Poincaré Invariant","title":"2nd Poincaré Integral Invariant","text":"","category":"section"},{"location":"poincare_invariant_2nd/","page":"2nd Poincaré Invariant","title":"2nd Poincaré Invariant","text":"Modules = [PoincareInvariants]\nPages   = [\"src/poincare_invariant_2nd.jl\",\n           \"src/poincare_invariant_2nd_canonical.jl\",\n           \"src/poincare_invariant_2nd_trapezoidal.jl\",\n           \"src/poincare_invariant_2nd_common.jl\"]","category":"page"},{"location":"example/#Poincaré-Integral-Invariant-Example","page":"Example","title":"Poincaré Integral Invariant Example","text":"","category":"section"},{"location":"example/#nd-Poincaré-Invariant","page":"Example","title":"2nd Poincaré Invariant","text":"","category":"section"},{"location":"example/","page":"Example","title":"Example","text":"Load modules","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"using GeometricIntegrators\nusing PoincareInvariants\nusing PyPlot","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Define functions for phasespace surface, one- and two-form and vector field","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"function surface(s, t, offset=1.0, factor=1.0)\n    [(offset+s)/factor, (offset+t)/factor, s, t]\nend\n\nfunction theta(t, q)\n    return [x[3] - x[2], x[4], 0., 0.]\nend\n\nfunction omega(t, q, B)\n    B .=   [[ 0.  1. -1.  0.]\n            [-1.  0.  0. -1.]\n            [ 1.  0.  0.  0.]\n            [ 0.  1.  0.  0.]]\nend\n\nfunction f(t, q, f)\n    f[1] =  q[3]\n    f[2] =  q[4]\n    f[3] = +q[4]\n    f[4] = -q[3]\nend\nnothing # hide","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Set parameters","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"const nd = 4\nconst n₀ = 100\nconst nt = 200\nconst Δt = 0.1\nnothing # hide","category":"page"},{"location":"example/#Trapezoidal-Quadrature","page":"Example","title":"Trapezoidal Quadrature","text":"","category":"section"},{"location":"example/","page":"Example","title":"Example","text":"Create Poincaré Invariant","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"pinv = PoincareInvariant2ndTrapezoidal(\n            x₀ -> ode = ODE(f, x₀), surface, omega,\n            Δt, nd, n₀, n₀, nt)\nnothing # hide","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Compute solution","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"tab = TableauGLRK(1)\nint = Integrator(pinv.equ, tab, pinv.Δt)\nsol = integrate(pinv.equ, int, pinv.ntime)\nnothing # hide","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Plot solution","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"fig = figure(figsize=(4,4))\nplot(sol.q[1,0,:], sol.q[2,0,:], \".\", markersize=.5)\nsavefig(\"example_2nd_trapezoidal_initial_state.svg\")\n\nfig = figure(figsize=(4,4))\nplot(sol.q[1,end,:], sol.q[2,end,:], \".\", markersize=.5)\nsavefig(\"example_2nd_trapezoidal_final_state.svg\")\n\nfig = figure(figsize=(4,4))\nfor i in 1:n₀\n    plot3D(sol.q[1,:,i], sol.q[2,:,i], collect(0:nt)*Δt)\nend\nsavefig(\"example_2nd_trapezoidal_evolution1.png\")\n\nfig = figure(figsize=(4,4))\nfor i in 0:20:nt\n    plot3D(sol.q[1,i,:], sol.q[2,i,:], i*Δt)\nend\nsavefig(\"example_2nd_trapezoidal_evolution2.png\")","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: Initial State) (Image: Final State)","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: Evolution) (Image: Evolution)","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Compute Poincarè invariant","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"I, J, ΔI, ΔJ = evaluate_poincare_invariant(pinv, sol)\npinv.I[0]","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Plot invariant error","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"yf = matplotlib[:ticker][:ScalarFormatter]()\nyf[:set_powerlimits]((-1,+1))\nyf[:set_scientific](true)\nyf[:set_useOffset](true)\n\nfig = figure(figsize=(8,4))\nplot((0:nt)*Δt, ΔI)\nax = gca()\nax[:yaxis][:set_major_formatter](yf)\nsavefig(\"example_2nd_trapezoidal.svg\")","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"example/#ApproxFun","page":"Example","title":"ApproxFun","text":"","category":"section"},{"location":"example/","page":"Example","title":"Example","text":"Create Poincaré Invariant","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"pinv = PoincareInvariant2ndApproxFun(\n            x₀ -> ode = ODE(f, x₀), surface, omega,\n            Δt, nd, n₀, n₀, nt)\nnothing # hide","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Compute solution","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"tab = TableauGLRK(1)\nint = Integrator(pinv.equ, tab, pinv.Δt)\nsol = integrate(pinv.equ, int, pinv.ntime)\nnothing # hide","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Plot solution","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"fig = figure(figsize=(4,4))\nplot(sol.q[1,0,:], sol.q[2,0,:], \".\", markersize=.5)\nsavefig(\"example_2nd_approxfun_initial_state.svg\")\n\nfig = figure(figsize=(4,4))\nplot(sol.q[1,end,:], sol.q[2,end,:], \".\", markersize=.5)\nsavefig(\"example_2nd_approxfun_final_state.svg\")\n\nfig = figure(figsize=(4,4))\nfor i in 1:n₀\n    plot3D(sol.q[1,:,i], sol.q[2,:,i], collect(0:nt)*Δt)\nend\nsavefig(\"example_2nd_approxfun_evolution1.png\")\n\nfig = figure(figsize=(4,4))\nfor i in 0:20:nt\n    plot3D(sol.q[1,i,:], sol.q[2,i,:], i*Δt)\nend\nsavefig(\"example_2nd_approxfun_evolution2.png\")","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: Initial State) (Image: Final State)","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: Evolution) (Image: Evolution)","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Compute Poincarè invariant","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"I, J, ΔI, ΔJ = evaluate_poincare_invariant(pinv, sol)\npinv.I[0]","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Plot invariant error","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"yf = matplotlib[:ticker][:ScalarFormatter]()\nyf[:set_powerlimits]((-1,+1))\nyf[:set_scientific](true)\nyf[:set_useOffset](true)\n\nfig = figure(figsize=(8,4))\nplot((0:nt)*Δt, ΔI)\nax = gca()\nax[:yaxis][:set_major_formatter](yf)\nsavefig(\"example_2nd_approxfun.svg\")","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"example/#OrthogonalPolynomialsQuasi","page":"Example","title":"OrthogonalPolynomialsQuasi","text":"","category":"section"},{"location":"example/","page":"Example","title":"Example","text":"Create Poincaré Invariant","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"pinv = PoincareInvariant2ndOPQ(\n            x₀ -> ode = ODE(f, x₀), surface, omega,\n            Δt, nd, n₀, n₀, nt)\nnothing # hide","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Compute solution","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"tab = TableauGLRK(1)\nint = Integrator(pinv.equ, tab, pinv.Δt)\nsol = integrate(pinv.equ, int, pinv.ntime)\nnothing # hide","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Plot solution","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"fig = figure(figsize=(4,4))\nplot(sol.q[1,0,:], sol.q[2,0,:], \".\", markersize=.5)\nsavefig(\"example_2nd_opq_initial_state.svg\")\n\nfig = figure(figsize=(4,4))\nplot(sol.q[1,end,:], sol.q[2,end,:], \".\", markersize=.5)\nsavefig(\"example_2nd_opq_final_state.svg\")\n\nfig = figure(figsize=(4,4))\nfor i in 1:n₀\n    plot3D(sol.q[1,:,i], sol.q[2,:,i], collect(0:nt)*Δt)\nend\nsavefig(\"example_2nd_opq_evolution1.png\")\n\nfig = figure(figsize=(4,4))\nfor i in 0:20:nt\n    plot3D(sol.q[1,i,:], sol.q[2,i,:], i*Δt)\nend\nsavefig(\"example_2nd_opq_evolution2.png\")","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: Initial State) (Image: Final State)","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: Evolution) (Image: Evolution)","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Compute Poincarè invariant","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"I, J, ΔI, ΔJ = evaluate_poincare_invariant(pinv, sol)\npinv.I[0]","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Plot invariant error","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"yf = matplotlib[:ticker][:ScalarFormatter]()\nyf[:set_powerlimits]((-1,+1))\nyf[:set_scientific](true)\nyf[:set_useOffset](true)\n\nfig = figure(figsize=(8,4))\nplot((0:nt)*Δt, ΔI)\nax = gca()\nax[:yaxis][:set_major_formatter](yf)\nsavefig(\"example_2nd_opq.svg\")","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"}]
}
